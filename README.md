# teensy_u2f

## Overview
This is a U2F implementation on Teensy 3.x.  Note there is another similar U2F implemtation [https://github.com/yohanes/teensy-u2f] but this implementation is different in many ways.

U2F stands for "Universal 2nd Factor", it is an open standard for 2nd factor authentication, i.e. users need to login with password + usdb dongle.   See [https://fidoalliance.org/specifications/overview/]

Teensy 3.x is a low cost microcontroller based on 32 bit ARM Cortex M4 , and it compatible with Arduino IDE and libraries. See [https://www.pjrc.com/teensy/index.html]

## Operation
Whenever an end user registers this U2F device on a website, this device will 
1. Generate a keypair
2. Assign a keyhandle - this is just a number from 0-9, as this device will only store 10 keys.
3. Store the private key in the Teensy's EEPROM along with a keyhandle and a 32 bit application identitfier passed by the website
4. (Optional) - Double blink the attached LED bar to indicate to the end user, that a key is being generated, and wait for user to press the button.  Note - the LED bar has 10 LEDs, and led corresponding to the keyhandle will blink.
5. Sign the public key with an attestation private key
6. Return the signed public key to the website.  

The website will remember the key handle and public key along with the end user's profile.


Later on when the website wants to authenticate the end user, the website will ask the device to sign with is private key and pass in the keyhandle and application identifier. Then the device will
1. Check that the passed in keyhandled and 32 bit application identified exists in the EEPROM, fetch the private key from the EEPROM
2. (Optional) - Single blink the appropriate LED, and wait for user to press the button.
3. Sign the challenge param with the private key.
4. Return the signed challenge to the website.

The website will then verify the signed challenge with the previously stored public key. 



## Security consideration
* There is no security element / secure EEPROM in Teensy, and it pretty easy to get the keys out of the device. But this can only happen when you lose the device itself and the attacker gets hold of the device. The keys generated by the device are pretty secure , so attackers hacking the website cannot get to your keys.  
* 

